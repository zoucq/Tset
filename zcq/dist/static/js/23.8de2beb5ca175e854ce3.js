webpackJsonp([23],{a6f0:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("woOf"),r=a.n(o),s=a("mvHQ"),l=a.n(s),i=a("OuSp"),n=a("gFd4"),m=(a("NYxO"),{components:{InputHouseSearch:i.a},data:function(){return{form:{ctime:"",customer_name:"",customer_tel:"",house_name:"",dep:"",group:"",user_id:"",has_kp:"",has_dz:""},dateFilter:["本月","上月","本周","上周","全部"],dateFilterCur:4,dataObj:{},page:1,pageSize:20,exportData:{}}},computed:{userInfo:function(){return this.$store.state.user.userInfo},infoPos:function(){var t=this.$store.state.user.infoPos;return t.dep&&(this.form.dep=t.dep),t.group&&(this.form.group=t.group),t.fxs&&(this.form.user_id=t.fxs),t},token:function(){return localStorage.getItem("token")}},watch:{"form.ctime":function(){this.getData()},"form.dep":function(){this.getData()},"form.group":function(){this.getData()},"form.user_id":function(){this.getData()},"form.house_name":function(){this.getData()},"form.customer_tel":function(){this.getData()},"form.customer_name":function(){this.getData()}},mounted:function(){this.getData()},methods:{getData:function(){var t=this,e=JSON.parse(l()(this.form)),a=r()(e,{action_name:"getSaleList",type:this.$route.params.type,page:this.page,pageSize:this.pageSize,time_start:this.form.ctime&&this.form.ctime[0]?this.form.ctime[0]:"",time_end:this.form.ctime&&this.form.ctime[1]?this.form.ctime[1]:"",ctime:""});this.$http.post("/api/v1/new_admin",a,function(e){e.data.show=!0,e.data.cjInfoShow=e.data.cjInfo&&[e.data.cjInfo],t.dataObj=e.data,t.exportData=a})},toDel:function(t){var e=this;this.$http.post("/api/v1/new_admin",{action_name:"deleteSaleRecord",id:t},function(t){e.$notify({title:"成功",message:"删除成功！",type:"success"}),e.getData()})},toEdit:function(t,e){var a={name:"/financial/success_detail",params:{id:t}};if(e){var o=this.$router.resolve(a).href;window.open(o,"_blank")}else this.$router.push(a)},departSelect:function(){this.form.group=""},groupSelect:function(){this.form.fxs=""},dateFilterHandle:function(t,e){this[e]=t;var a=void 0;a=1==t?{time_start:n.a.getCurrentYesterday().format("yyyy-MM-dd"),time_end:n.a.getCurrentYesterday().format("yyyy-MM-dd")}:2==t?{time_start:n.a.getCurrentWeek()[0].format("yyyy-MM-dd"),time_end:n.a.getCurrentWeek()[1].format("yyyy-MM-dd")}:3==t?{time_start:n.a.getPreviousWeek()[0].format("yyyy-MM-dd"),time_end:n.a.getPreviousWeek()[1].format("yyyy-MM-dd")}:{time_start:"",time_end:""},this.form.ctime=[a.time_start,a.time_end]},pageChange:function(t){this.page=t,this.getData()},clickSearch:function(){this.page=1,this.getData()},resetFrom:function(t){this.$refs[t].resetFields(),this.page=1,this.getData()},exportList:function(t){this.exportData.action_name="exportSaleList",this.exportData.page&&(delete this.exportData.page,delete this.exportData.pageSize);var e=this.exportData,a="";for(var o in e)a+=o+"="+e[o]+"&";a=a.substring(0,a.length-1)+"&ac_token="+this.token,this.$refs.iframeExport.src="https://admin.91xiangju.com/api/v1/new_admin?"+a}}}),u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.dataObj.show?a("div",{staticClass:"public_mt caiwu_tf"},[a("div",{staticClass:"guide_filter"},[a("el-form",{ref:"form",staticClass:"filter_form",attrs:{inline:!0,model:t.form,"label-position":"left","label-width":"90px"}},[a("div",{staticClass:"search_group"},[a("el-form-item",{attrs:{label:"部门：",prop:"dep"}},[t.infoPos.dep_arr?a("el-select",{attrs:{disabled:!!t.infoPos.dep,placeholder:"请选择"},on:{change:t.departSelect},model:{value:t.form.dep,callback:function(e){t.$set(t.form,"dep",e)},expression:"form.dep"}},t._l(t.infoPos.dep_arr,function(t){return a("el-option",{key:t.k,attrs:{label:t.v,value:t.k}})}),1):t._e()],1),t._v(" "),a("el-form-item",{attrs:{label:"战队：",prop:"group"}},[" "!=t.form.dep&&t.infoPos.group_arr[t.form.dep]&&t.infoPos.group_arr[t.form.dep].groups?a("el-select",{attrs:{disabled:!!t.infoPos.group,placeholder:"请选择"},on:{change:t.groupSelect},model:{value:t.form.group,callback:function(e){t.$set(t.form,"group",e)},expression:"form.group"}},t._l(t.infoPos.group_arr[t.form.dep].groups,function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})}),1):a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.group,callback:function(e){t.$set(t.form,"group",e)},expression:"form.group"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"分析师：",prop:"user_id"}},[t.form.dep&&t.form.group?a("el-select",{attrs:{disabled:!!t.infoPos.fxs,placeholder:"请选择"},model:{value:t.form.user_id,callback:function(e){t.$set(t.form,"user_id",e)},expression:"form.user_id"}},t._l(t.infoPos.fxs_arr[t.form.dep][t.form.group],function(e){return t.infoPos.fxs_arr[t.form.dep][t.form.group]?a("el-option",{key:e.v,attrs:{label:e.v,value:e.k}}):t._e()}),1):a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.user_id,callback:function(e){t.$set(t.form,"user_id",e)},expression:"form.user_id"}})],1)],1),t._v(" "),a("div",{staticClass:"search_group"},[a("el-form-item",{attrs:{label:"成交楼盘：",prop:"house_name"}},[a("InputHouseSearch",{model:{value:t.form.house_name,callback:function(e){t.$set(t.form,"house_name",e)},expression:"form.house_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"客户姓名：",prop:"customer_name"}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.form.customer_name,callback:function(e){t.$set(t.form,"customer_name",e)},expression:"form.customer_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"客户电话：",prop:"customer_tel"}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.form.customer_tel,callback:function(e){t.$set(t.form,"customer_tel",e)},expression:"form.customer_tel"}})],1)],1),t._v(" "),a("div",{staticClass:"search_group time_group"},[a("el-form-item",{attrs:{label:"时间：",prop:"ctime"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.form.ctime,callback:function(e){t.$set(t.form,"ctime",e)},expression:"form.ctime"}})],1)],1),t._v(" "),a("div",{staticClass:"filter_buttons"},[a("button",{staticClass:"my_btn",attrs:{type:"button"},on:{click:function(e){return t.exportList("formExport")}}},[t._v("导出")]),t._v(" "),a("button",{staticClass:"my_btn",attrs:{type:"button"},on:{click:function(e){return t.resetFrom("form")}}},[t._v("清空条件")]),t._v(" "),a("button",{staticClass:"my_btn my_btn_main",attrs:{type:"button"},on:{click:function(e){return t.clickSearch("form")}}},[t._v("搜索")])])])],1),t._v(" "),a("iframe",{ref:"iframeExport",staticStyle:{display:"none"},attrs:{id:"iframeExport"}}),t._v(" "),a("div",{staticClass:"success_info"},[t.dataObj.cjInfoShow?a("div",{staticClass:"total"},[a("div",{staticClass:"title"},[t._v("总计")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.dataObj.cjInfoShow,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"sale_money_total",label:"成交佣金(元)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sale_total_2",label:"总成交数(套)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"daozhang_money_total",label:"总到账佣金(元)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"fanyong_money_total",label:"总返佣金额(元)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"kaipiao_money_total",label:"总开票金额(元)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sale_money_tuifan_total",label:"总退房金额(元)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tuifan_total",label:"总退房(套)"}})],1)],1):t._e(),t._v(" "),a("div",{staticClass:"total"},[a("div",{staticClass:"title"},[t._v("明细")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.dataObj.list,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"Atime",label:"退房时间",width:"130"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{directives:[{name:"format",rawName:"v-format",value:{value:t.row.Atime,type:"yyyy年MM月dd日"},expression:'{value:scope.row.Atime,type:"yyyy年MM月dd日"}'}]})]}}],null,!1,3858572929)}),t._v(" "),a("el-table-column",{attrs:{prop:"user_name",label:"成交人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"CustomerName",label:"客户姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"CustomerTel",label:"客户电话",width:"130"}}),t._v(" "),a("el-table-column",{attrs:{prop:"SumMoney",label:"成交总佣金"}}),t._v(" "),a("el-table-column",{attrs:{prop:"HouseName",label:"成交楼盘"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Aremark",label:"退房备注"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"134"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"caozuo_btn"},[a("el-button",{on:{click:function(a){return t.toEdit(e.row.Sid,!0)}}},[t._v("编辑")])],1)]}}],null,!1,1408090953)})],1),t._v(" "),0!=t.dataObj.total?a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:1*t.dataObj.total,"page-size":t.pageSize},on:{"current-change":t.pageChange}}):t._e()],1)])]):t._e()},staticRenderFns:[]};var c=a("VU/8")(m,u,!1,function(t){a("mbdb")},null,null);e.default=c.exports},mbdb:function(t,e){}});