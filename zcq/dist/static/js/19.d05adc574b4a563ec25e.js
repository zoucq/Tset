webpackJsonp([19],{"Xtw/":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("woOf"),r=a.n(o),l=a("mvHQ"),s=a.n(l),i=a("gFd4"),n={data:function(){return{dataObj:{},page:1,pageSize:20,dialogCommetVisible:!1,commet:"",commetId:"",dialogFormVisible:!1,titleDialogText:"成交总结",isGuideSuccess:"",form:{customer_name:"",customer_tel:"",action_time:"",region:"",house_name:"",house_id:"",channel_name:"",channel_username:"",channel_tel:"",zygw_name:"",zygw_tel:"",imgs:"",customer_info:"",result:"",ext_data:[{house_name:"",channel_name:"",channel_username:"",channel_tel:"",zygw_name:"",zygw_tel:""}]},editCurrent:{},formLabelWidth:"120px",dialogImageUrl:"https://admin.91xiangju.com/api/v1/new_admin",dialogVisible:!1,fileList:[],dateFilter:["不限","昨天","本周","上周"],dateFilterCur:0,formSearch:{ctime:"",username:"",phone:"",house_name:"",dep:"",group:"",user_id:""}}},computed:{infoPos:function(){var e=this.$store.state.user.infoPos;return e.dep&&(this.formSearch.dep=e.dep),e.group&&(this.formSearch.group=e.group),e.fxs&&(this.formSearch.user_id=e.fxs),e},userInfo:function(){return this.$store.state.user.userInfo},token:function(){return localStorage.getItem("token")}},mounted:function(){this.getData()},methods:{getData:function(){var e=this,t=JSON.parse(s()(this.formSearch));t.ctime="";var a=r()(t,{action_name:"getCjResList",page:this.page,pageSize:this.pageSize,time_start:this.formSearch.ctime?this.formSearch.ctime[0]:"",time_end:this.formSearch.ctime?this.formSearch.ctime[1]:""});this.infoPos.dep&&(a.dep=""),this.infoPos.group&&(a.group=""),this.infoPos.user_id&&(a.user_id=""),this.$http.post("/api/v1/new_admin",a,function(t){t.data.list.map(function(e,t){"[object Object],[object Object]"!=e.ExtData&&"[object Object]"!=e.ExtData&&""!=e.ExtData||(e.ExtData=[]),e.ExtData=""==e.ExtData?[]:JSON.parse(e.ExtData),e.ExtData2=e.ExtData}),t.data.show=!0,e.dataObj=t.data})},handleRemove:function(e,t){console.log(e,t),this.fileList=t},handlePictureCardPreview:function(e){console.log(e),this.dialogImageUrl=e.url,this.dialogVisible=!0},handlePictureBeforeUpload:function(e){console.log(e)},handlePictureSuccess:function(e,t,a){console.log(e,t,a),this.fileList.push({url:e.data.url,data:t,name:t.name})},handlePictureError:function(e,t,a){console.log(e),this.$notify({title:"错误",message:"上传失败",type:"error"})},pageChange:function(e){this.page=e,this.getData()},commetDialog:function(e){this.commetId=e.Id,this.dialogCommetVisible=!0},addCommet:function(){var e=this;this.$http.post("/api/v1/new_admin",{action_name:"saveDkCjComment",record_id:this.commetId,content:this.commet,type:3},function(t){e.dialogCommetVisible=!1,e.$notify({title:"成功",message:"评论成功！",type:"success"}),e.commet="",e.getData()})},editDialog:function(e){var t=JSON.parse(s()(e));this.editCurrent=t,this.form={action_name:"saveCjRes",id:t.Id,customer_id:t.CustomerId,customer_name:t.CustomerName,house_name:t.HouseName,action_time:t.ActionTime,customer_info:t.CustomerInfo,channel_name:t.ChannelName,channel_username:t.ChannelUsername,channel_tel:t.ChannelTel,zygw_name:t.ZygwName,zygw_tel:t.ZygwTel,result:t.Result,ext_data:t.ExtData,user_name:t.UserName},t.Imgs&&t.Imgs.length>0?this.fileList=t.Imgs.map(function(e,t){return{url:e}}):this.fileList=[],this.dialogFormVisible=!0},saveForm:function(){var e=this,t=JSON.parse(s()(this.form));this.fileList&&this.fileList.length>0?t.imgs=this.fileList.map(function(e,t){return e.url}):t.imgs=[],t.imgs=s()(t.imgs),t.ext_data=s()(t.ext_data),this.$http.post("/api/v1/new_admin",t,function(t){e.$notify({title:"成功",message:"保存成功！",type:"success"}),e.dialogFormVisible=!1,e.getData()})},querySearchAsync:function(e,t){e&&0!=e.length&&this.$http.post("/api/v1/new_admin",{action_name:"houseTip",term:e},function(e){t(e.data)})},handleHouseSelect:function(e){this.form.house_name=e.label,this.form.house_id=e.id},departSelect:function(){this.formSearch.group=""},groupSelect:function(){this.formSearch.user_id=""},dateFilterHandle:function(e,t){this[t]=e;var a=void 0;a=1==e?{time_start:i.a.getCurrentYesterday().format("yyyy-MM-dd"),time_end:i.a.getCurrentYesterday().format("yyyy-MM-dd")}:2==e?{time_start:i.a.getCurrentWeek()[0].format("yyyy-MM-dd"),time_end:i.a.getCurrentWeek()[1].format("yyyy-MM-dd")}:3==e?{time_start:i.a.getPreviousWeek()[0].format("yyyy-MM-dd"),time_end:i.a.getPreviousWeek()[1].format("yyyy-MM-dd")}:{time_start:"",time_end:""},this.formSearch.ctime=[a.time_start,a.time_end]},clickSearch:function(){this.page=1,this.getData()},resetFrom:function(e){this.dateFilterCur=0,this.$refs[e].resetFields(),this.getData()},routerPush:function(e,t){if(t){var a=this.$router.resolve(e).href;window.open(a,"_blank")}else this.$router.push(e)},add_project:function(){this.form.ext_data.push({house_name:"",channel_name:"",channel_username:"",channel_tel:"",zygw_name:"",zygw_tel:""})},projectDel:function(e){this.form.ext_data.splice(e,1)},delItem:function(e){var t=this;this.$confirm("确认删除？").then(function(a){t.$http.post("/api/v1/new_admin",{action_name:"deleteDkCj",type:"cj_res",id:e.Id},function(e){t.$notify({title:"成功",message:"删除成功！",type:"success"}),t.getData()})}).catch(function(e){})}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container saleman_chengjiaototal"},[a("div",{staticClass:"guide_filter"},[a("el-form",{ref:"formSearch",staticClass:"filter_form",attrs:{inline:!0,model:e.formSearch,"label-position":"left","label-width":"76px"}},[a("div",{staticClass:"search_group"},[a("el-form-item",{attrs:{label:"部门：",prop:"dep","label-width":"64px"}},[a("el-select",{attrs:{disabled:!!e.infoPos.dep,placeholder:"请选择"},on:{change:e.departSelect},model:{value:e.formSearch.dep,callback:function(t){e.$set(e.formSearch,"dep",t)},expression:"formSearch.dep"}},e._l(e.infoPos.dep_arr,function(e){return a("el-option",{key:e.k,attrs:{label:e.v,value:e.k}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"战队：",prop:"group","label-width":"64px"}},[e.infoPos.group_arr[e.formSearch.dep]&&e.infoPos.group_arr[e.formSearch.dep].groups?a("el-select",{attrs:{disabled:!!e.infoPos.group,placeholder:"请选择"},on:{change:e.groupSelect},model:{value:e.formSearch.group,callback:function(t){e.$set(e.formSearch,"group",t)},expression:"formSearch.group"}},e._l(e.infoPos.group_arr[e.formSearch.dep].groups,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1):a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formSearch.group,callback:function(t){e.$set(e.formSearch,"group",t)},expression:"formSearch.group"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"分析师：",prop:"user_id","label-width":"64px"}},[e.infoPos.fxs_arr[e.formSearch.dep]&&e.infoPos.fxs_arr[e.formSearch.dep][e.formSearch.group]?a("el-select",{attrs:{disabled:!!e.infoPos.fxs,placeholder:"请选择"},model:{value:e.formSearch.user_id,callback:function(t){e.$set(e.formSearch,"user_id",t)},expression:"formSearch.user_id"}},e._l(e.infoPos.fxs_arr[e.formSearch.dep][e.formSearch.group],function(e){return a("el-option",{key:e.v,attrs:{label:e.v,value:e.k}})}),1):a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formSearch.group,callback:function(t){e.$set(e.formSearch,"group",t)},expression:"formSearch.group"}})],1)],1),e._v(" "),a("div",{staticClass:"search_group"},[a("el-form-item",{attrs:{label:"客户姓名：",prop:"username"}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.formSearch.username,callback:function(t){e.$set(e.formSearch,"username",t)},expression:"formSearch.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客户电话：",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.formSearch.phone,callback:function(t){e.$set(e.formSearch,"phone",t)},expression:"formSearch.phone"}})],1)],1),e._v(" "),a("div",{staticClass:"search_group time_group"},[a("el-form-item",{attrs:{label:"时间：",prop:"ctime"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.formSearch.ctime,callback:function(t){e.$set(e.formSearch,"ctime",t)},expression:"formSearch.ctime"}}),e._v(" "),a("div",{staticClass:"date_select"},e._l(e.dateFilter,function(t,o){return a("el-button",{key:o,class:{active:e.dateFilterCur==o},on:{click:function(t){return e.dateFilterHandle(o,"dateFilterCur")}}},[e._v(e._s(t))])}),1)],1)],1),e._v(" "),a("div",{staticClass:"filter_buttons"},[a("button",{staticClass:"my_btn",attrs:{type:"button"},on:{click:function(t){return e.resetFrom("formSearch")}}},[e._v("清空条件")]),e._v(" "),a("button",{staticClass:"my_btn my_btn_main",attrs:{type:"button"},on:{click:function(t){return e.clickSearch("formSearch")}}},[e._v("搜索")])])])],1),e._v(" "),e._l(e.dataObj.list,function(t,o){return a("div",{key:o,staticClass:"comeguide_item"},[a("div",{staticClass:"comeguide_item_l"},[a("div",{staticClass:"date"},[a("span",{directives:[{name:"format",rawName:"v-format",value:{value:t.Ctime},expression:"{value:item.Ctime}"}]}),e._v("分发布")]),e._v(" "),a("div",{staticClass:"label_item"},[a("label",{attrs:{for:""}},[e._v("分析师：")]),e._v(" "),a("div",[e._v(e._s(t.UserName))])]),e._v(" "),a("div",{staticClass:"label_item"},[a("label",{attrs:{for:""}},[e._v("客户姓名：")]),e._v(" "),a("div",[e._v(e._s(t.CustomerName))])]),e._v(" "),a("div",{staticClass:"label_item"},[a("label",{attrs:{for:""}},[e._v("成交时间：")]),e._v(" "),a("div",[e._v(e._s(t.ActionTime))])]),e._v(" "),a("div",{staticClass:"label_item"},[a("label",{attrs:{for:""}},[e._v("成交天数：")]),e._v(" "),a("div",[e._v(e._s(t.CjDays)+"天")])]),e._v(" "),a("div",{staticClass:"label_item_img"},[a("label",{attrs:{for:""}},[e._v("成交项目：")]),e._v(" "),a("div",{staticClass:"add_project_table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.ExtData,"header-row-class-name":"project_th","row-class-name":"project_row",border:""}},[a("el-table-column",{attrs:{label:"项目名称",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"project_text"},[e._v(e._s(t.row.house_name))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"渠道名",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"project_text"},[e._v(e._s(t.row.channel_name))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"渠道对接人",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"project_text"},[e._v(e._s(t.row.channel_username))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"渠道电话",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"project_text"},[e._v(e._s(t.row.channel_tel))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"置业顾问",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"project_text"},[e._v(e._s(t.row.zygw_name))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"置业顾问电话",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"project_text"},[e._v(e._s(t.row.zygw_tel))])]}}],null,!0)})],1)],1)]),e._v(" "),a("div",{staticClass:"label_item_img"},[a("label",{attrs:{for:""}},[e._v("图片资料：")]),e._v(" "),a("div",{staticClass:"img_box"},[a("viewer",{attrs:{images:t.Imgs}},e._l(t.Imgs,function(e,t){return a("img",{key:t,attrs:{src:e,alt:""}})}),0)],1)]),e._v(" "),a("div",{staticClass:"label_item_img"},[a("label",{attrs:{for:""}},[e._v("客户情况：")]),e._v(" "),a("div",{staticClass:"preLine"},[e._v(e._s(t.CustomerInfo))])]),e._v(" "),a("div",{staticClass:"label_item_img"},[a("label",{attrs:{for:""}},[e._v("经验分享：")]),e._v(" "),a("div",{staticClass:"preLine"},[e._v(e._s(t.Result))])])]),e._v(" "),a("div",{staticClass:"comeguide_item_r"},[a("div",{staticClass:"item_box"},[a("div",{staticClass:"title"},[e._v("点评：")]),e._v(" "),a("div",{staticClass:"dp_item_box"},e._l(t.Comments,function(t,o){return a("div",{key:o,staticClass:"dp_item"},[a("div",{staticClass:"preLine dp_item_body"},[e._v(e._s(t.Content))]),e._v(" "),a("div",{staticClass:"dp_item_info"},[a("span",{directives:[{name:"format",rawName:"v-format",value:{value:t.Ctime},expression:"{value:v.Ctime}"}]},[e._v(e._s(t.Ctime))]),e._v(" "),a("span",{staticClass:"m_l"},[e._v(e._s(t.UserName)+"（"+e._s(t.RoleName)+"）")])])])}),0)]),e._v(" "),a("div",{staticClass:"buttons"},[a("button",{staticClass:"my_btn",on:{click:function(a){return e.routerPush({name:"/customer/detail",params:{id:t.CustomerId}},!0)}}},[e._v("查看客户详情")]),e._v(" "),a("button",{staticClass:"my_btn",on:{click:function(a){return e.delItem(t)}}},[e._v("删除")]),e._v(" "),a("button",{staticClass:"my_btn",on:{click:function(a){return e.editDialog(t)}}},[e._v("修改")]),e._v(" "),a("button",{staticClass:"my_btn my_btn_main",on:{click:function(a){return e.commetDialog(t)}}},[e._v("点评")])])])])}),e._v(" "),e.dataObj.total&&0!=e.dataObj.total?a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.dataObj.total,"current-page":e.page,"page-size":e.pageSize},on:{"current-change":e.pageChange}}):e._e(),e._v(" "),a("el-dialog",{attrs:{"custom-class":"commet_dialog",title:"发表你的评论",visible:e.dialogCommetVisible,center:!0,width:"564px"},on:{"update:visible":function(t){e.dialogCommetVisible=t}}},[a("div",{staticClass:"commet_box"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.commet,expression:"commet"}],attrs:{cols:"30",rows:"10",placeholder:"输入内容"},domProps:{value:e.commet},on:{input:function(t){t.target.composing||(e.commet=t.target.value)}}})]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addCommet}},[e._v("发布")])],1)]),e._v(" "),a("el-dialog",{attrs:{"custom-class":"guide_total_dialog",title:e.titleDialogText,visible:e.dialogFormVisible,center:!0,top:"8vh",width:"721px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"客户姓名：","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入客户姓名"},model:{value:e.form.customer_name,callback:function(t){e.$set(e.form,"customer_name",t)},expression:"form.customer_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"分析师：","label-width":e.formLabelWidth}},[a("div",[e._v(e._s(e.form.user_name))])]),e._v(" "),a("el-form-item",{attrs:{label:"成交时间：","label-width":e.formLabelWidth}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.form.action_time,callback:function(t){e.$set(e.form,"action_time",t)},expression:"form.action_time"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"成交项目：","label-width":e.formLabelWidth,prop:"house_name"}},[a("button",{staticClass:"add_btn",attrs:{type:"button"},on:{click:e.add_project}},[a("i",{staticClass:"el-icon-plus"}),e._v("添加")])]),e._v(" "),a("div",{staticClass:"add_project_table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:""==e.form.ext_data?[]:e.form.ext_data,"header-row-class-name":"project_th","row-class-name":"project_row",border:""}},[a("el-table-column",{attrs:{label:"项目名称",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearchAsync,placeholder:"请输入内容"},on:{select:e.handleHouseSelect},model:{value:e.form.ext_data[t.$index].house_name,callback:function(a){e.$set(e.form.ext_data[t.$index],"house_name",a)},expression:"form.ext_data[scope.$index].house_name"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"渠道名",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{autocomplete:"off",placeholder:"渠道名"},model:{value:e.form.ext_data[t.$index].channel_name,callback:function(a){e.$set(e.form.ext_data[t.$index],"channel_name",a)},expression:"form.ext_data[scope.$index].channel_name"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"渠道对接人",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{autocomplete:"off",placeholder:"渠道对接人"},model:{value:e.form.ext_data[t.$index].channel_username,callback:function(a){e.$set(e.form.ext_data[t.$index],"channel_username",a)},expression:"form.ext_data[scope.$index].channel_username"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"渠道电话",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{autocomplete:"off",placeholder:"渠道电话"},model:{value:e.form.ext_data[t.$index].channel_tel,callback:function(a){e.$set(e.form.ext_data[t.$index],"channel_tel",a)},expression:"form.ext_data[scope.$index].channel_tel"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"置业顾问",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{autocomplete:"off",placeholder:"置业顾问"},model:{value:e.form.ext_data[t.$index].zygw_name,callback:function(a){e.$set(e.form.ext_data[t.$index],"zygw_name",a)},expression:"form.ext_data[scope.$index].zygw_name"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"置业顾问电话",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{autocomplete:"off",placeholder:"置业顾问电话"},model:{value:e.form.ext_data[t.$index].zygw_tel,callback:function(a){e.$set(e.form.ext_data[t.$index],"zygw_tel",a)},expression:"form.ext_data[scope.$index].zygw_tel"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("button",{staticClass:"my_btn my_btn_defalut",attrs:{type:"button"},on:{click:function(a){return e.projectDel(t.$index)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"图片资料：","label-width":e.formLabelWidth}},[a("el-upload",{attrs:{action:e.dialogImageUrl,"list-type":"picture-card",headers:{"ac-token":e.token},"file-list":e.fileList,data:{action_name:"uploadFile"},name:"file","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"on-success":e.handlePictureSuccess,"on-error":e.handlePictureError}},[a("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"客户情况：","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.form.customer_info,callback:function(t){e.$set(e.form,"customer_info",t)},expression:"form.customer_info"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"经验分享：","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.form.result,callback:function(t){e.$set(e.form,"result",t)},expression:"form.result"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveForm("dialogFormVisible")}}},[e._v("保存")])],1)],1)],2)},staticRenderFns:[]};var m=a("VU/8")(n,c,!1,function(e){a("kwcz")},null,null);t.default=m.exports},kwcz:function(e,t){}});