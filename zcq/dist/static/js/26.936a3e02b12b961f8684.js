webpackJsonp([26],{bGiu:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("woOf"),i=s.n(a),l=s("mvHQ"),r=s.n(l),o=(s("gFd4"),{data:function(){return{searchVisible:!0,classCurrent:-1,bqUserCurrent:-1,form:{ctime:"",last_follow_time:"",name:"",mobile:"",house:"",tag:"",search_key:""},dataObj:{},page:1,pageSize:50,total:0,sysTags2:{},sysTags3:{},editIndex:"",dialogEdit:!1,editForm:{tag:"",impt_group:""},formLabelWidth:"110px",editTxlForm:{action_name:"saveCustomer",id:"",remark_name:"",note:"",group_id:"",user_tags:""},dialogTxlEdit:!1,editTxlIndex:"",sortType:""}},computed:{infoPos:function(){var t=this.$store.state.user.infoPos;return t},impt:function(){return this.$store.state.user.impt},customerTags:function(){return this.$store.state.user.customerTags},sysTags:function(){return this.$store.state.user.sysTags}},mounted:function(){this.sysTags3=this.sysTagsIn(),this.getData()},methods:{sysTagsIn:function(){return this.$store.state.user.sysTags&&JSON.parse(r()(this.$store.state.user.sysTags))},selectManyHandle:function(t,e){this.$set(this[e][t],"active",!this[e][t].active)},selectHandle:function(t,e){this[e]=t},pageChange:function(t){console.log(t),this.page=t,this.getData()},getData:function(){var t=this,e=[];if(this.dataObj.init_data)for(var s in this.dataObj.init_data.filter.SysTags)this.dataObj.init_data.filter.SysTags[s].active&&e.push(this.dataObj.init_data.filter.SysTags[s].value);var a={action_name:"customerList",type:this.$route.params.type,system_tags:e.join(","),user_tags:-1==this.bqUserCurrent?"":this.bqUserCurrent,group_id:-1==this.classCurrent?"":this.classCurrent,phone:this.form.mobile,remark_username:this.form.name,page:this.page,pagesize:this.pageSize,ctime_begin:this.form.ctime?this.form.ctime[0]:"",ctime_stop:this.form.ctime?this.form.ctime[1]:"",last_follow_time_begin:this.form.last_follow_time?this.form.last_follow_time[0]:"",last_follow_time_stop:this.form.last_follow_time?this.form.last_follow_time[1]:"",sort_field:this.sortType},l=JSON.parse(r()(this.form));l.ctime="",l.last_follow_time="",a=i()(l,a),this.$http.post("/api/v1/new_admin",a,function(e){t.dataObj.init_data&&t.dataObj.init_data.filter&&(e.data.init_data.filter=t.dataObj.init_data.filter),e.data.show=!0,t.dataObj=e.data,t.total=e.data.res.total})},selectMore:function(t,e){this.$set(this.dataObj.init_data.filter[e][t],"active",!this.dataObj.init_data.filter[e][t].active)},clickSearch:function(){this.page=1,this.getData()},clickSearchVisible:function(){this.searchVisible=!this.searchVisible},resetFrom:function(t){for(var e in this.$refs[t].resetFields(),this.dataObj.init_data.filter.SysTags)this.$set(this.dataObj.init_data.filter.SysTags[e],"active",!1);this.classCurrent=-1,this.bqUserCurrent=-1,this.page=1,this.getData()},toDetail:function(t,e){if(t={name:"/customer/detail",params:{id:t.CustomerId}},e){var s=this.$router.resolve(t).href;window.open(s,"_blank")}else this.$router.push(t)},toEdit:function(t){var e=this;for(var s in console.log(this.dataObj.res.list[t]),this.sysTags3)this.$set(this.sysTags3[s],"active",!1);this.editForm.tag=this.dataObj.res.list[t].CustomerAllInfo.tag,this.editForm.impt_group=this.dataObj.res.list[t].CustomerAllInfo.impt_group&&this.dataObj.res.list[t].CustomerAllInfo.impt_group.value,this.dataObj.res.list[t].CustomerAllInfo.sys_tags&&this.dataObj.res.list[t].CustomerAllInfo.sys_tags.map(function(t,s){for(var a in e.sysTags3)t.value==e.sysTags3[a].value&&e.$set(e.sysTags3[a],"active",!0)}),this.editIndex=t,this.dialogEdit=!0},saveEditForm:function(){var t=this;if(console.log(22,this.editIndex),!(this.editIndex<0)){var e=[];if(this.sysTags3)for(var s in this.sysTags3)this.sysTags3[s].active&&e.push(this.sysTags3[s].value);this.$http.post("/api/v1/new_admin",{action_name:"customerSave",id:this.dataObj.res.list[this.editIndex].CustomerAllInfo.id,name:this.dataObj.res.list[this.editIndex].CustomerAllInfo.name,impt_group:this.editForm.impt_group,mobile:this.dataObj.res.list[this.editIndex].CustomerAllInfo.mobile_fixed,customer_house:this.dataObj.res.list[this.editIndex].CustomerAllInfo.house_id,tag:this.editForm.tag,sys_tags:e.join(","),log:this.editForm.log},function(e){for(var s in t.$notify({title:"成功",message:"保存成功！",type:"success"}),t.dialogEdit=!1,t.sysTags3)t.$set(t.sysTags3[s],"active",!1);t.editForm.log="",t.getData()})}},txlUserTagEdit:function(t){this.$set(this.dataObj.init_data.filter.UserTagsAll[t],"active",!this.dataObj.init_data.filter.UserTagsAll[t].active)},toTxlEdit:function(t){var e=this;this.dataObj.init_data.filter.UserTagsAll.map(function(t,s){e.$set(t,"active",!1)}),this.editTxlForm.remark_name=this.dataObj.res.list[t].RemarkUsername,this.editTxlForm.note=this.dataObj.res.list[t].Note,this.editTxlForm.group_id=0==this.dataObj.res.list[t].GroupId?"":this.dataObj.res.list[t].GroupId,this.editTxlForm.user_tags=this.dataObj.res.list[t].UserTags&&this.dataObj.res.list[t].UserTags.split(","),this.dataObj.init_data.filter.UserTagsAll.map(function(t,s){e.editTxlForm.user_tags&&e.editTxlForm.user_tags.map(function(s,a){t.TagName==s&&e.$set(t,"active",!0)})}),this.editTxlIndex=t,this.dialogTxlEdit=!0},saveEditTxlForm:function(){var t=this;if(!(this.editTxlIndex<0)){var e=[];this.dataObj.init_data.filter.UserTagsAll.map(function(t,s){t.active&&e.push(t.TagName)});var s=JSON.parse(r()(this.editTxlForm));s=i()(s,{id:this.dataObj.res.list[this.editTxlIndex].Id,user_tags:e.join(",")}),this.$http.post("/api/v1/new_admin",s,function(e){t.$notify({title:"成功",message:"保存成功！",type:"success"}),t.dialogTxlEdit=!1,t.getData()})}},sortChange:function(t){"ascending"==t.order&&(t.prop=""),this.sortType=t.prop,this.getData()}}}),n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.dataObj.show?a("div",{staticClass:"container txl_customer"},[a("div",{staticClass:"txl_search"},[a("div",{staticClass:"open_search",on:{click:t.clickSearchVisible}},[t._v("\n\t\t\t客户分类选择器\n\t\t\t"),a("img",{class:{open:t.searchVisible},attrs:{src:s("Xq76"),alt:""}})]),t._v(" "),a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.searchVisible,expression:"searchVisible"}],staticClass:"search_box"},[t.dataObj.init_data?a("div",{staticClass:"search_item"},[a("div",{staticClass:"search_key"},[t._v("分类：")]),t._v(" "),a("ul",{staticClass:"search_item_key"},t._l(t.dataObj.init_data.filter.UserGroupsAll,function(e,s){return a("li",{key:s,class:t.classCurrent==e.Id?"active":"",on:{click:function(s){return t.selectHandle(e.Id,"classCurrent")}}},[t._v(t._s(e.GroupName))])}),0)]):t._e(),t._v(" "),t.dataObj.init_data?a("div",{staticClass:"search_item"},[a("div",[a("div",{staticClass:"search_key"},[t._v("系统标签：")]),t._v(" "),a("ul",{staticClass:"search_item_key bq_system"},t._l(t.dataObj.init_data.filter.SysTags,function(e,s){return a("li",{key:s,class:e.active?"active":"",on:{click:function(e){return t.selectMore(s,"SysTags")}}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.text))])}),0)]),t._v(" "),a("div",[a("div",{staticClass:"search_key"},[t._v("个人标签：")]),t._v(" "),a("ul",{staticClass:"search_item_key user_system"},t._l(t.dataObj.init_data.filter.UserTagsAll,function(e,s){return a("li",{key:s,class:t.bqUserCurrent==s?"active":"",on:{click:function(e){return t.selectHandle(s,"bqUserCurrent")}}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.TagName))])}),0)])]):t._e(),t._v(" "),a("div",{staticClass:"search_select"},[a("div",{staticClass:"search_title"},[t._v("搜索和筛选：")]),t._v(" "),a("el-form",{ref:"form",staticClass:"demo-form-inline",attrs:{inline:!0,model:t.form}},[a("div",{staticClass:"search_group"},[a("el-form-item",{attrs:{label:"客户姓名：",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"客户电话：",prop:"mobile"}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.form.mobile,callback:function(e){t.$set(t.form,"mobile",e)},expression:"form.mobile"}})],1)],1),t._v(" "),a("div",{staticClass:"buttons"},[a("el-button",{staticClass:"btn_clear",on:{click:function(e){return t.resetFrom("form")}}},[t._v("清空条件")]),t._v(" "),a("el-button",{staticClass:"btn_submit",on:{click:function(e){return t.clickSearch("form")}}},[t._v("搜索")])],1)])],1)])])],1),t._v(" "),t.dataObj.res?a("div",{staticClass:"public_mt txl_data"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.dataObj.res.list,stripe:"",border:"","header-row-class-name":"customer_table_th"},on:{"sort-change":t.sortChange}},[a("el-table-column",{attrs:{prop:"RemarkUsername",label:"备注姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Note",label:"客户情况",width:"160px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t"+t._s(e.row.Note)+"\n\t\t\t\t")]}}],null,!1,2392788901)}),t._v(" "),a("el-table-column",{attrs:{label:"客户电话"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.CustomerAllInfo.mobile_fixed))]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.row.CustomerAllInfo.mobile_location,expression:"scope.row.CustomerAllInfo.mobile_location"}]},[t._v("( "+t._s(e.row.CustomerAllInfo.mobile_location)+" )")])]}}],null,!1,624579813)}),t._v(" "),a("el-table-column",{attrs:{prop:"GroupName",label:"通讯录分组"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t"+t._s(0==e.row.GroupId?"未分组":e.row.GroupName)+"\n\t\t\t\t")]}}],null,!1,3755973314)}),t._v(" "),a("el-table-column",{attrs:{prop:"SystemTags",label:"系统标签"}}),t._v(" "),a("el-table-column",{attrs:{prop:"UserTags",label:"个人标签"}}),t._v(" "),a("el-table-column",{attrs:{label:"意向楼盘"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t"+t._s(e.row.CustomerAllInfo.house_name)+"\n\t\t\t\t")]}}],null,!1,1897459564)}),t._v(" "),a("el-table-column",{attrs:{label:"认领的分析师"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t"+t._s(e.row.CustomerAllInfo.saleman)+"\n\t\t\t\t")]}}],null,!1,1824829737)}),t._v(" "),a("el-table-column",{attrs:{prop:"ip",label:"IP"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.CustomerAllInfo.ip))]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.row.CustomerAllInfo.ip_address_string,expression:"scope.row.CustomerAllInfo.ip_address_string"}]},[t._v("( "+t._s(e.row.CustomerAllInfo.ip_address_string)+" )")])]}}],null,!1,4038946221)}),t._v(" "),a("el-table-column",{attrs:{label:"最新跟进",width:"134"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.CustomerAllInfo.brief_remark,function(e,s){return a("div",{key:s,staticClass:"gengjin_item"},[a("div",{domProps:{innerHTML:t._s(e.remark)}},[t._v(t._s(e.remark))]),t._v(" "),a("div",{staticClass:"gengjin_item_time"},[t._v(t._s(e.time))])])})}}],null,!1,3109331198)}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"114"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"caozuo_btn"},[a("el-button",{staticClass:"to_edit_btn",on:{click:function(s){return t.toTxlEdit(e.$index)}}},[t._v("快捷操作")]),t._v(" "),a("el-button",{staticClass:"to_detail_btn",on:{click:function(s){return t.toDetail(e.row,!0)}}},[t._v("详情")])],1)]}}],null,!1,3916550761)})],1)],1):t._e(),t._v(" "),0!=t.total?a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.total,"current-page":t.page,"page-size":t.pageSize},on:{"current-change":t.pageChange}}):t._e(),t._v(" "),a("el-dialog",{attrs:{"custom-class":"edit_dialog",title:"快捷操作",visible:t.dialogEdit,center:!0,top:"12vh",width:"426px"},on:{"update:visible":function(e){t.dialogEdit=e}}},[a("el-form",{attrs:{model:t.editForm}},[a("el-form-item",{attrs:{label:"客户级别：","label-width":t.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.editForm.tag,callback:function(e){t.$set(t.editForm,"tag",e)},expression:"editForm.tag"}},t._l(t.customerTags,function(t,e){return a("el-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"重点客户分组：","label-width":t.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.editForm.impt_group,callback:function(e){t.$set(t.editForm,"impt_group",e)},expression:"editForm.impt_group"}},t._l(t.impt,function(t){return a("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"系统标签：","label-width":t.formLabelWidth}},[a("ul",{staticClass:"search_item_key"},t._l(t.sysTags3,function(e,s){return a("li",{key:s,class:e.active?"active":"",on:{click:function(e){return t.selectManyHandle(s,"sysTags3")}}},[t._v(t._s(e.text))])}),0)]),t._v(" "),a("el-form-item",{attrs:{label:"跟进记录：","label-width":t.formLabelWidth}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.editForm.log,expression:"editForm.log"}],attrs:{name:"",id:"",cols:"30",rows:"10"},domProps:{value:t.editForm.log},on:{input:function(e){e.target.composing||t.$set(t.editForm,"log",e.target.value)}}})])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.saveEditForm}},[t._v("保存")])],1)],1),t._v(" "),a("el-dialog",{attrs:{"custom-class":"edit_dialog",title:"快捷操作",visible:t.dialogTxlEdit,center:!0,top:"12vh",width:"426px"},on:{"update:visible":function(e){t.dialogTxlEdit=e}}},[a("el-form",{attrs:{model:t.editTxlForm}},[a("el-form-item",{attrs:{label:"姓名备注：","label-width":t.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.editTxlForm.remark_name,callback:function(e){t.$set(t.editTxlForm,"remark_name",e)},expression:"editTxlForm.remark_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"客户情况：","label-width":t.formLabelWidth}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.editTxlForm.note,expression:"editTxlForm.note"}],attrs:{placeholder:"请输入内容"},domProps:{value:t.editTxlForm.note},on:{input:function(e){e.target.composing||t.$set(t.editTxlForm,"note",e.target.value)}}})]),t._v(" "),a("el-form-item",{attrs:{label:"分组：","label-width":t.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.editTxlForm.group_id,callback:function(e){t.$set(t.editTxlForm,"group_id",t._n(e))},expression:"editTxlForm.group_id"}},t._l(t.dataObj.init_data.filter.UserGroupsAll,function(t){return a("el-option",{key:t.Id,attrs:{label:t.GroupName,value:t.Id}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"个人标签：","label-width":t.formLabelWidth}},[a("ul",{staticClass:"search_item_key"},t._l(t.dataObj.init_data.filter.UserTagsAll,function(e,s){return a("li",{key:s,class:e.active?"active":"",on:{click:function(e){return t.txlUserTagEdit(s)}}},[t._v(t._s(e.TagName))])}),0)])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.saveEditTxlForm}},[t._v("保存")])],1)],1)],1):t._e()},staticRenderFns:[]};var d=s("VU/8")(o,n,!1,function(t){s("ej3C")},"data-v-0c01c922",null);e.default=d.exports},ej3C:function(t,e){}});