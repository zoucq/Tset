webpackJsonp([12],{Q41g:function(t,e){},W7ot:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("woOf"),o=s.n(a),r=s("mvHQ"),i=s.n(r),l={data:function(){return{datas:[],page:1,pageSize:50,total:0,customerSelectCurrent:1,dataObj:{},sysTags3:{},editIndex:"",dialogEdit:!1,editForm:{tag:"",impt_group:""},formLabelWidth:"120px",sortType:"",sortMode:"",form:{dep:"",group:"",user_id:""}}},computed:{infoPos:function(){var t=this.$store.state.user.infoPos;return t.dep&&(this.form.dep=t.dep),t.group&&(this.form.group=t.group),t.fxs&&(this.form.user_id=t.fxs),t},impt:function(){return this.$store.state.user.impt},customerTags:function(){return this.$store.state.user.customerTags}},watch:{"form.dep":function(){this.form.group="",this.getData()},"form.group":function(){this.form.user_id="",this.getData()},"form.user_id":function(){this.getData()}},mounted:function(){this.sysTags3=this.sysTagsIn(),this.getData()},methods:{selectHandle:function(t,e){this[e]=t,this.page=1,this.getData()},sysTagsIn:function(){return this.$store.state.user.sysTags&&JSON.parse(i()(this.$store.state.user.sysTags))},selectManyHandle:function(t,e){this.$set(this[e][t],"active",!this[e][t].active)},pageChange:function(t){console.log(t),this.page=t,this.getData()},getData:function(){var t=this,e=o()({action_name:"customerList",type:this.$route.params.type,impt_group:this.customerSelectCurrent,sort_field:this.sortType,sort_mode:this.sortMode,page:this.page,pagesize:this.pageSize},this.form);this.$http.post("/api/v1/new_admin",e,function(e){t.dataObj=e.data,t.total=e.data.res.total})},toDetail:function(t,e){if(t={name:"/customer/detail",params:{id:t.id}},e){var s=this.$router.resolve(t).href;window.open(s,"_blank")}else this.$router.push(t)},toEdit:function(t){var e=this;for(var s in console.log(this.dataObj.res.customers[t]),this.sysTags3)this.$set(this.sysTags3[s],"active",!1);this.editForm.tag=this.dataObj.res.customers[t].tag,this.editForm.impt_group=this.dataObj.res.customers[t].impt_group&&this.dataObj.res.customers[t].impt_group.value,this.dataObj.res.customers[t].sys_tags&&this.dataObj.res.customers[t].sys_tags.map(function(t,s){for(var a in e.sysTags3)t.value==e.sysTags3[a].value&&e.$set(e.sysTags3[a],"active",!0)}),this.editIndex=t,this.dialogEdit=!0},saveEditForm:function(){var t=this;if(console.log(22,this.editIndex),!(this.editIndex<0)){var e=[];if(this.sysTags3)for(var s in this.sysTags3)this.sysTags3[s].active&&e.push(this.sysTags3[s].value);this.$http.post("/api/v1/new_admin",{action_name:"customerSave",id:this.dataObj.res.customers[this.editIndex].id,name:this.dataObj.res.customers[this.editIndex].name,impt_group:this.editForm.impt_group,mobile:this.dataObj.res.customers[this.editIndex].mobile_fixed,customer_house:this.dataObj.res.customers[this.editIndex].house_id,tag:this.editForm.tag,sys_tags:e.join(","),log:this.editForm.log},function(e){for(var s in t.$notify({title:"成功",message:"保存成功！",type:"success"}),t.dialogEdit=!1,t.sysTags3)t.$set(t.sysTags3[s],"active",!1);t.editForm.log="",t.getData()})}},sortChange:function(t){"tag"==t.prop?t.order?"ascending"==t.order?(t.prop="",t.sort_mode="desc"):t.sort_mode="asc":t.sort_mode="":t.order?t.sort_mode="ascending"==t.order?"asc":"desc":t.sort_mode="",this.sortType=t.prop,this.sortMode=t.sort_mode,this.getData()}}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"zdcustomer"},[s("div",{staticClass:"group public_mt "},[s("div",{staticClass:"title"},[s("div",{staticClass:"t_left"},[s("div",{staticClass:"t_name"},[t._v("重点客户情况\n\t\t\t\t")]),t._v(" "),t.dataObj.init_data?s("div",{staticClass:"t_type"},t._l(t.dataObj.init_data.menus,function(e,a){return s("span",{key:a,class:e.value==t.customerSelectCurrent?"active":"",on:{click:function(s){return t.selectHandle(e.value,"customerSelectCurrent")}}},[t._v(t._s(e.text))])}),0):t._e()]),t._v(" "),s("div",{staticClass:"t_right filter_small"},[s("el-select",{attrs:{disabled:!!t.infoPos.dep,placeholder:"请选择"},model:{value:t.form.dep,callback:function(e){t.$set(t.form,"dep",e)},expression:"form.dep"}},t._l(t.infoPos.dep_arr,function(t){return s("el-option",{key:t.k,attrs:{label:t.v,value:t.k}})}),1),t._v(" "),t.infoPos.group_arr[t.form.dep]?s("el-select",{attrs:{disabled:!!t.infoPos.group,placeholder:"请选择"},model:{value:t.form.group,callback:function(e){t.$set(t.form,"group",e)},expression:"form.group"}},t._l(t.infoPos.group_arr[t.form.dep].groups,function(t){return s("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})}),1):s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.group,callback:function(e){t.$set(t.form,"group",e)},expression:"form.group"}}),t._v(" "),t.infoPos.fxs_arr[t.form.dep]?s("el-select",{attrs:{disabled:!!t.infoPos.fxs,placeholder:"请选择"},model:{value:t.form.user_id,callback:function(e){t.$set(t.form,"user_id",e)},expression:"form.user_id"}},t._l(t.infoPos.fxs_arr[t.form.dep][t.form.group],function(e){return t.infoPos.fxs_arr[t.form.dep]?s("el-option",{key:e.v,attrs:{label:e.v,value:e.k}}):t._e()}),1):s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.user_id,callback:function(e){t.$set(t.form,"user_id",e)},expression:"form.user_id"}})],1)]),t._v(" "),s("div",{staticClass:"sub_title"},[s("div",[t._v("当前重点客户")]),t._v(" "),s("el-badge",{staticClass:"item",attrs:{value:t.total}})],1),t._v(" "),t.dataObj.res?s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.dataObj.res.customers,stripe:"",border:"","header-row-class-name":"customer_table_th"},on:{"sort-change":t.sortChange}},[s("el-table-column",{attrs:{prop:"name",label:"客户姓名"}}),t._v(" "),s("el-table-column",{attrs:{prop:"mobile_fixed",label:"客户电话"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",[t._v(t._s(e.row.mobile_fixed))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.row.mobile_location,expression:"scope.row.mobile_location"}]},[t._v("( "+t._s(e.row.mobile_location)+" )")])]}}],null,!1,2838822309)}),t._v(" "),s("el-table-column",{attrs:{prop:"house_name",label:"意向楼盘"}}),t._v(" "),s("el-table-column",{attrs:{prop:"tag",label:"客户级别",sortable:"custom",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.tag?s("div",[s("div",{staticClass:"customer_tags",class:"tag_"+e.row.tag},[t._v(t._s(e.row.tag))]),t._v(" "),s("div",{staticClass:"customer_tags_text"},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.customerTags[e.row.tag]&&t.customerTags[e.row.tag].text.split(":")[1])+"\n\t\t\t\t\t\t")])]):t._e()]}}],null,!1,4224146470)}),t._v(" "),s("el-table-column",{attrs:{prop:"saleman",label:"分析师"}}),t._v(" "),s("el-table-column",{attrs:{prop:"ip",label:"IP"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",[t._v(t._s(e.row.ip))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.row.ip_address_string,expression:"scope.row.ip_address_string"}]},[t._v("( "+t._s(e.row.ip_address_string)+" )")])]}}],null,!1,1656427629)}),t._v(" "),s("el-table-column",{attrs:{prop:"reg_time",label:"登记时间",sortable:"custom",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",[t._v(t._s(e.row.register_time))])]}}],null,!1,3822565874)}),t._v(" "),s("el-table-column",{attrs:{prop:"impt_group",label:"重点客户分组"}}),t._v(" "),s("el-table-column",{attrs:{prop:"sys_tags",label:"标签"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.sys_tags,function(a,o){return s("span",{key:o},[t._v("\n\t\t\t\t\t\t"+t._s(o==e.row.sys_tags.length-1?a.text:a.text+" / ")+"\n\t\t\t\t\t")])})}}],null,!1,1032654051)}),t._v(" "),s("el-table-column",{attrs:{label:"最新跟进",width:"138",prop:"last_follow_time",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.brief_remark,function(e,a){return s("div",{key:a,staticClass:"gengjin_item"},[s("div",{domProps:{innerHTML:t._s(e.remark)}},[t._v(t._s(e.remark))]),t._v(" "),s("div",{staticClass:"gengjin_item_time"},[t._v(t._s(e.time))])])})}}],null,!1,2781881243)}),t._v(" "),s("el-table-column",{attrs:{label:"操作",width:"114"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"caozuo_btn"},[s("el-button",{on:{click:function(s){return t.toEdit(e.$index)}}},[t._v("快捷操作")]),t._v(" "),s("el-button",{staticClass:"to_detail_btn",on:{click:function(s){return t.toDetail(e.row,!0)}}},[t._v("详情")])],1)]}}],null,!1,3233271126)})],1):t._e()],1),t._v(" "),0!=t.total?s("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.total,"current-page":t.page,"page-size":t.pageSize},on:{"current-change":t.pageChange}}):t._e(),t._v(" "),s("el-dialog",{attrs:{"custom-class":"edit_dialog",title:"快捷操作",visible:t.dialogEdit,center:!0,top:"12vh",width:"426px"},on:{"update:visible":function(e){t.dialogEdit=e}}},[s("el-form",{attrs:{model:t.editForm}},[s("el-form-item",{attrs:{label:"客户级别：","label-width":t.formLabelWidth}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.editForm.tag,callback:function(e){t.$set(t.editForm,"tag",e)},expression:"editForm.tag"}},t._l(t.customerTags,function(t,e){return s("el-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"重点客户分组：","label-width":t.formLabelWidth}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.editForm.impt_group,callback:function(e){t.$set(t.editForm,"impt_group",e)},expression:"editForm.impt_group"}},t._l(t.impt,function(t){return s("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})}),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"系统标签：","label-width":t.formLabelWidth}},[s("ul",{staticClass:"search_item_key"},t._l(t.sysTags3,function(e,a){return s("li",{key:a,class:e.active?"active":"",on:{click:function(e){return t.selectManyHandle(a,"sysTags3")}}},[t._v(t._s(e.text))])}),0)]),t._v(" "),s("el-form-item",{attrs:{label:"跟进记录：","label-width":t.formLabelWidth}},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.editForm.log,expression:"editForm.log"}],attrs:{name:"",id:"",cols:"30",rows:"10"},domProps:{value:t.editForm.log},on:{input:function(e){e.target.composing||t.$set(t.editForm,"log",e.target.value)}}})])],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:t.saveEditForm}},[t._v("保存")])],1)],1)],1)},staticRenderFns:[]};var u=s("VU/8")(l,n,!1,function(t){s("Q41g")},"data-v-7fa25be3",null);e.default=u.exports}});