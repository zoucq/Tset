webpackJsonp([10],{HwXd:function(t,e){},gEiJ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("mvHQ"),l=a.n(o),i={components:{noData:a("sqAx").a},data:function(){return{dataObj:{},page:1,pageSize:20,dialogCommetVisible:!1,commet:"",commetId:"",dialogFormVisible:!1,titleDialogText:"带看总结",isGuideSuccess:"",form:{customer_name:"",customer_tel:"",action_time:"",region:"",house_name:"",house_id:"",channel_name:"",channel_username:"",channel_tel:"",zygw_name:"",zygw_tel:"",imgs:"",customer_info:"",zongjie:"",ext_data:[{house_name:"",channel_name:"",channel_username:"",channel_tel:"",zygw_name:"",zygw_tel:""}]},editCurrent:{},formLabelWidth:"120px",dialogImageUrl:"https://admin.91xiangju.com/api/v1/new_admin",dialogVisible:!1,fileList:[]}},computed:{userInfo:function(){return this.$store.state.user.userInfo},token:function(){return localStorage.getItem("token")}},mounted:function(){this.getData()},methods:{handleRemove:function(t,e){console.log(t,e),this.fileList=e},handlePictureCardPreview:function(t){console.log(t),this.dialogImageUrl=t.url,this.dialogVisible=!0},handlePictureBeforeUpload:function(t){console.log(t)},handlePictureSuccess:function(t,e,a){console.log(t,e,a),this.fileList.push({url:t.data.url,data:e,name:e.name})},handlePictureError:function(t,e,a){console.log(t),this.$notify({title:"错误",message:"上传失败",type:"error"})},pageChange:function(t){this.page=t,this.getData()},getData:function(){var t=this;this.$http.post("/api/v1/new_admin",{action_name:"getDkResList",customer_id:this.$route.params.id,page:this.page,pageSize:this.pageSize},function(e){e.data.list.map(function(t,e){"[object Object],[object Object]"==t.ExtData&&(t.ExtData=[]),t.ExtData=""!=t.ExtData?JSON.parse(t.ExtData):[],t.ExtData2=t.ExtData}),e.data.show=!0,t.dataObj=e.data})},commetDialog:function(t){this.commetId=t.Id,this.dialogCommetVisible=!0},addCommet:function(){var t=this;this.$http.post("/api/v1/new_admin",{action_name:"saveDkCjComment",record_id:this.commetId,content:this.commet,type:2},function(e){t.dialogCommetVisible=!1,t.$notify({title:"成功",message:"评论成功！",type:"success"}),t.commet="",t.getData()})},editDialog:function(t){var e=JSON.parse(l()(t));this.editCurrent=e,this.form={action_name:"saveDkRes",id:e.Id,customer_id:e.CustomerId,customer_name:e.CustomerName,house_name:e.HouseName,action_time:e.ActionTime,customer_info:e.CustomerInfo,channel_name:e.ChannelName,channel_username:e.ChannelUsername,channel_tel:e.ChannelTel,zygw_name:e.ZygwName,zygw_tel:e.ZygwTel,after_work:e.AfterWork,ext_data:e.ExtData,user_name:e.UserName},e.Imgs&&e.Imgs.length>0?this.fileList=e.Imgs.map(function(t,e){return{url:t}}):this.fileList=[],this.dialogFormVisible=!0},saveForm:function(){var t=this,e=JSON.parse(l()(this.form));this.fileList&&this.fileList.length>0?e.imgs=this.fileList.map(function(t,e){return t.url}):e.imgs=[],e.imgs=l()(e.imgs),e.ext_data=l()(e.ext_data),this.$http.post("/api/v1/new_admin",e,function(e){t.$notify({title:"成功",message:"保存成功！",type:"success"}),t.dialogFormVisible=!1,t.getData()})},querySearchAsync:function(t,e){t&&0!=t.length&&this.$http.post("/api/v1/new_admin",{action_name:"houseTip",term:t},function(t){e(t.data)})},handleHouseSelect:function(t){this.form.house_name=t.label,this.form.house_id=t.id},add_project:function(){this.form.ext_data.push({house_name:"",channel_name:"",channel_username:"",channel_tel:"",zygw_name:"",zygw_tel:""})},projectDel:function(t){this.form.ext_data.splice(t,1)},delItem:function(t){var e=this;this.$confirm("确认删除？").then(function(a){e.$http.post("/api/v1/new_admin",{action_name:"deleteDkCj",type:"dk_res",id:t.Id},function(t){e.$notify({title:"成功",message:"删除成功！",type:"success"}),e.getData()})}).catch(function(t){})}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.dataObj.show?a("div",{staticClass:"container guidetotal"},[t.dataObj.list&&0==t.dataObj.list.length?a("noData"):t._e(),t._v(" "),t._l(t.dataObj.list,function(e,o){return a("div",{key:o,staticClass:"comeguide_item"},[a("div",{staticClass:"comeguide_item_l"},[a("div",{staticClass:"date"},[a("span",{directives:[{name:"format",rawName:"v-format",value:{value:e.Ctime},expression:"{value:item.Ctime}"}]}),t._v("分发布")]),t._v(" "),a("div",{staticClass:"label_item"},[a("label",{attrs:{for:""}},[t._v("分析师：")]),t._v(" "),a("div",[t._v(t._s(e.UserName))])]),t._v(" "),a("div",{staticClass:"label_item"},[a("label",{attrs:{for:""}},[t._v("客户姓名：")]),t._v(" "),a("div",[t._v(t._s(e.CustomerName))])]),t._v(" "),a("div",{staticClass:"label_item"},[a("label",{attrs:{for:""}},[t._v("带看时间：")]),t._v(" "),a("div",[t._v(t._s(e.ActionTime))])]),t._v(" "),a("div",{staticClass:"label_item_img"},[a("label",{attrs:{for:""}},[t._v("带看项目：")]),t._v(" "),a("div",{staticClass:"add_project_table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.ExtData,"header-row-class-name":"project_th","row-class-name":"project_row",border:""}},[a("el-table-column",{attrs:{label:"项目名称",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"project_text"},[t._v(t._s(e.row.house_name))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{label:"渠道名",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"project_text"},[t._v(t._s(e.row.channel_name))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{label:"渠道对接人",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"project_text"},[t._v(t._s(e.row.channel_username))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{label:"渠道电话",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"project_text"},[t._v(t._s(e.row.channel_tel))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{label:"置业顾问",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"project_text"},[t._v(t._s(e.row.zygw_name))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{label:"置业顾问电话",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"project_text"},[t._v(t._s(e.row.zygw_tel))])]}}],null,!0)})],1)],1)]),t._v(" "),a("div",{staticClass:"label_item_img"},[a("label",{attrs:{for:""}},[t._v("图片资料：")]),t._v(" "),a("div",{staticClass:"img_box"},[a("viewer",{attrs:{images:e.Imgs}},t._l(e.Imgs,function(t,e){return a("img",{key:e,attrs:{src:t,alt:""}})}),0)],1)]),t._v(" "),a("div",{staticClass:"label_item_img"},[a("label",{attrs:{for:""}},[t._v("带看后客户情况：")]),t._v(" "),a("div",{staticClass:"preLine box"},[t._v(t._s(e.CustomerInfo))])]),t._v(" "),a("div",{staticClass:"label_item_img"},[a("label",{attrs:{for:""}},[t._v("后期跟进方案：")]),t._v(" "),a("div",{staticClass:"preLine box"},[t._v(t._s(e.AfterWork))])])]),t._v(" "),a("div",{staticClass:"comeguide_item_r"},[a("div",{staticClass:"item_box"},[a("div",{staticClass:"title"},[t._v("点评：")]),t._v(" "),a("div",{staticClass:"dp_item_box"},t._l(e.Comments,function(e,o){return a("div",{key:o,staticClass:"dp_item"},[a("div",{staticClass:"preLine dp_item_body"},[t._v(t._s(e.Content))]),t._v(" "),a("div",{staticClass:"dp_item_info"},[a("span",{directives:[{name:"format",rawName:"v-format",value:{value:e.Ctime},expression:"{value:v.Ctime}"}]},[t._v(t._s(e.Ctime))]),t._v(" "),a("span",{staticClass:"m_l"},[t._v(t._s(e.UserName)+"（"+t._s(e.RoleName)+"）")])])])}),0)]),t._v(" "),a("div",{staticClass:"buttons"},[a("button",{staticClass:"my_btn",on:{click:function(a){return t.delItem(e)}}},[t._v("删除")]),t._v(" "),a("button",{staticClass:"my_btn",on:{click:function(a){return t.editDialog(e)}}},[t._v("修改")]),t._v(" "),a("button",{staticClass:"my_btn my_btn_main",on:{click:function(a){return t.commetDialog(e)}}},[t._v("点评")])])])])}),t._v(" "),t.dataObj.total&&0!=t.dataObj.total?a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.dataObj.total,"page-size":t.pageSize},on:{"current-change":t.pageChange}}):t._e(),t._v(" "),a("el-dialog",{attrs:{title:"发表你的评论",visible:t.dialogCommetVisible,center:!0,width:"564px"},on:{"update:visible":function(e){t.dialogCommetVisible=e}}},[a("div",{staticClass:"commet_box"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commet,expression:"commet"}],attrs:{cols:"30",rows:"10",placeholder:"输入内容"},domProps:{value:t.commet},on:{input:function(e){e.target.composing||(t.commet=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.addCommet}},[t._v("发布")])],1)]),t._v(" "),a("el-dialog",{attrs:{"custom-class":"guide_total_dialog",title:t.titleDialogText,visible:t.dialogFormVisible,center:!0,top:"8vh",width:"721px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"form",attrs:{model:t.form}},[a("el-form-item",{attrs:{label:"客户姓名：","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入客户姓名"},model:{value:t.form.customer_name,callback:function(e){t.$set(t.form,"customer_name",e)},expression:"form.customer_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"分析师：","label-width":t.formLabelWidth}},[a("div",[t._v(t._s(t.form.user_name))])]),t._v(" "),a("el-form-item",{attrs:{label:"带看时间：","label-width":t.formLabelWidth}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:t.form.action_time,callback:function(e){t.$set(t.form,"action_time",e)},expression:"form.action_time"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"带看项目：","label-width":t.formLabelWidth,prop:"house_name"}},[a("button",{staticClass:"add_btn",attrs:{type:"button"},on:{click:t.add_project}},[a("i",{staticClass:"el-icon-plus"}),t._v("添加")])]),t._v(" "),a("div",{staticClass:"add_project_table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:""==t.form.ext_data?[]:t.form.ext_data,"header-row-class-name":"project_th","row-class-name":"project_row",border:""}},[a("el-table-column",{attrs:{label:"项目名称",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-autocomplete",{attrs:{"fetch-suggestions":t.querySearchAsync,placeholder:"请输入内容"},on:{select:t.handleHouseSelect},model:{value:t.form.ext_data[e.$index].house_name,callback:function(a){t.$set(t.form.ext_data[e.$index],"house_name",a)},expression:"form.ext_data[scope.$index].house_name"}})]}}],null,!1,335270566)}),t._v(" "),a("el-table-column",{attrs:{label:"渠道名",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{autocomplete:"off",placeholder:"渠道名"},model:{value:t.form.ext_data[e.$index].channel_name,callback:function(a){t.$set(t.form.ext_data[e.$index],"channel_name",a)},expression:"form.ext_data[scope.$index].channel_name"}})]}}],null,!1,3737749970)}),t._v(" "),a("el-table-column",{attrs:{label:"渠道对接人",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{autocomplete:"off",placeholder:"渠道对接人"},model:{value:t.form.ext_data[e.$index].channel_username,callback:function(a){t.$set(t.form.ext_data[e.$index],"channel_username",a)},expression:"form.ext_data[scope.$index].channel_username"}})]}}],null,!1,1285968776)}),t._v(" "),a("el-table-column",{attrs:{label:"渠道电话",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{autocomplete:"off",placeholder:"渠道电话"},model:{value:t.form.ext_data[e.$index].channel_tel,callback:function(a){t.$set(t.form.ext_data[e.$index],"channel_tel",a)},expression:"form.ext_data[scope.$index].channel_tel"}})]}}],null,!1,1432837005)}),t._v(" "),a("el-table-column",{attrs:{label:"置业顾问",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{autocomplete:"off",placeholder:"置业顾问"},model:{value:t.form.ext_data[e.$index].zygw_name,callback:function(a){t.$set(t.form.ext_data[e.$index],"zygw_name",a)},expression:"form.ext_data[scope.$index].zygw_name"}})]}}],null,!1,3176407416)}),t._v(" "),a("el-table-column",{attrs:{label:"置业顾问电话",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{autocomplete:"off",placeholder:"置业顾问电话"},model:{value:t.form.ext_data[e.$index].zygw_tel,callback:function(a){t.$set(t.form.ext_data[e.$index],"zygw_tel",a)},expression:"form.ext_data[scope.$index].zygw_tel"}})]}}],null,!1,465995050)}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("button",{staticClass:"my_btn my_btn_defalut",attrs:{type:"button"},on:{click:function(a){return t.projectDel(e.$index)}}},[t._v("删除")])]}}],null,!1,927485414)})],1)],1),t._v(" "),t._e(),t._v(" "),a("el-form-item",{attrs:{label:"图片资料：","label-width":t.formLabelWidth}},[a("el-upload",{attrs:{action:t.dialogImageUrl,"list-type":"picture-card",headers:{"ac-token":t.token},"file-list":t.fileList,data:{action_name:"uploadFile"},name:"file","on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"on-success":t.handlePictureSuccess,"on-error":t.handlePictureError}},[a("i",{staticClass:"el-icon-plus"})])],1),t._v(" "),a("el-form-item",{attrs:{label:"带看后情况：","label-width":t.formLabelWidth}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.customer_info,expression:"form.customer_info"}],attrs:{name:"",cols:"30",rows:"10"},domProps:{value:t.form.customer_info},on:{input:function(e){e.target.composing||t.$set(t.form,"customer_info",e.target.value)}}})]),t._v(" "),a("el-form-item",{attrs:{label:"后期跟进方案：","label-width":t.formLabelWidth}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.after_work,expression:"form.after_work"}],attrs:{name:"",cols:"30",rows:"10"},domProps:{value:t.form.after_work},on:{input:function(e){e.target.composing||t.$set(t.form,"after_work",e.target.value)}}})])],2),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.saveForm("dialogFormVisible")}}},[t._v("保存")])],1)],1)],2):t._e()},staticRenderFns:[]};var s=a("VU/8")(i,n,!1,function(t){a("HwXd")},null,null);e.default=s.exports}});