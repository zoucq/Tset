webpackJsonp([2],{L1et:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={components:{InputHouseSearch:a("OuSp").a},data:function(){return{dataObj:{},page:1,pageSize:50,total:0,sortType:"",sortMode:"",formLabelWidth:"90px",addCustomerDialog:!1,addCustomerForm:{customer_name:"",customer_tel:"",house_name:"",house_id:"",quyu:[]},cityOptions:[],cityProps:{value:"Id",label:"Name",children:"children"},arrCity:[],cityOpt:{action_name:"addressCascade",pid:""}}},mounted:function(){this.getData(),0==this.cityOptions.length&&this.cityData()},computed:{menus:function(){return this.$store.state.user.menus}},methods:{pageChange:function(t){this.page=t,this.getData()},toRenling:function(t){var e=this;this.$http.post("/api/v1/new_admin",{action_name:t.has_take?"cancelRenlin":"renlin",id:t.id},function(a){e.$notify({title:"成功",message:t.has_take?"取消认领成功！":"认领成功！",type:"success"}),e.getData()})},toDetail:function(t,e){if(t={name:"/customer/detail",params:{id:t.id}},e){var a=this.$router.resolve(t).href;window.open(a,"_blank")}else this.$router.push(t)},getData:function(){var t=this,e={action_name:"customerList",type:this.$route.params.type||"new",sort_field:this.sortType,sort_mode:this.sortMode,page:this.page,pagesize:this.pageSize};this.$http.post("/api/v1/new_admin",e,function(e){t.dataObj=e.data,t.total=e.data.res.total})},sortChange:function(t){"tag"==t.prop?t.order?"ascending"==t.order?(t.prop="",t.sort_mode="desc"):t.sort_mode="asc":t.sort_mode="":t.order?t.sort_mode="ascending"==t.order?"asc":"desc":t.sort_mode="",this.sortType=t.prop,this.sortMode=t.sort_mode,this.getData()},addCustomerVisible:function(){this.addCustomerDialog=!0},addCustomerHide:function(){this.$refs.addCustomerForm.resetFields(),this.addCustomerDialog=!1},saveNewCustomer:function(){var t=this,e={action_name:"createCustomer",name:this.addCustomerForm.customer_name,mobile:this.addCustomerForm.customer_tel,customer_house:this.addCustomerForm.house_id,demand_region:this.addCustomerForm.quyu.join(",")};this.$http.post("/api/v1/new_admin",e,function(e){t.$notify({title:"成功",message:"保存成功！",type:"success"}),t.$refs.addCustomerForm.resetFields(),t.addCustomerDialog=!1})},cityItemChange:function(t){this.arrCity=t,t[2]?this.cityOpt.pid=t[2]:t[1]?this.cityOpt.pid=t[1]:t[0]&&(this.cityOpt.pid=t[0]),this.cityData()},cityData:function(){var t=this;this.$http.post("/api/v1/new_admin",this.cityOpt,function(e){t.arrCity.length<=2&&e.data.map(function(e,a){e.label=e.Name,e.value=e.Id,t.arrCity.length<2&&(e.children=[])}),t.cityOpt.pid?t.cityOptions.map(function(a,o){t.arrCity[2]?a.children.map(function(t,a){t.children.map(function(t,a){t.children=e.data})}):t.arrCity[1]?a.children.map(function(t,a){t.children=e.data}):t.arrCity[0]&&(a.children=e.data)}):t.cityOptions=e.data})},selectHouse:function(t){this.addCustomerForm.house_id=t.id}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"newcustomer"},[a("div",{staticClass:"table_box"},[a("div",{staticClass:"title"},[a("div",[t._v("当前新客户")]),t._v(" "),a("el-badge",{staticClass:"item",attrs:{value:t.total}}),t._v(" "),a("button",{staticClass:"add_btn add_new_btn",attrs:{type:"button"},on:{click:t.addCustomerVisible}},[a("i",{staticClass:"el-icon-plus"}),t._v("添加")])],1),t._v(" "),t.dataObj.res?a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.dataObj.res.customers,"header-row-class-name":"customer_table_th",border:"",stripe:""},on:{"sort-change":t.sortChange}},[a("el-table-column",{attrs:{prop:"name",label:"客户姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mobile_fixed",label:"客户电话",width:"108"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.mobile_fixed))]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.row.mobile_location,expression:"scope.row.mobile_location"}]},[t._v("( "+t._s(e.row.mobile_location)+" )")])]}}],null,!1,2838822309)}),t._v(" "),a("el-table-column",{attrs:{prop:"house_name",label:"来源楼盘"}}),t._v(" "),a("el-table-column",{attrs:{prop:"u_channel",label:"来源渠道"}}),t._v(" "),a("el-table-column",{attrs:{label:"来源类型",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.type_array,function(e,o){return a("div",{key:o},[t._v("\n\t\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t\t")])})}}],null,!1,1596795450)}),t._v(" "),a("el-table-column",{attrs:{prop:"reg_time",label:"登记时间",sortable:"custom",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.register_time))])]}}],null,!1,3822565874)}),t._v(" "),a("el-table-column",{attrs:{prop:"ip",label:"IP"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.ip))]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.row.ip_address_string,expression:"scope.row.ip_address_string"}]},[t._v("( "+t._s(e.row.ip_address_string)+" )")])]}}],null,!1,1656427629)}),t._v(" "),a("el-table-column",{attrs:{prop:"u_keyword",label:"关键词"}}),t._v(" "),a("el-table-column",{attrs:{prop:"fenxishi",label:"预约分析师"}}),t._v(" "),a("el-table-column",{attrs:{prop:"saleman",label:"认领分析师"}}),t._v(" "),a("el-table-column",{attrs:{label:"最新跟进",width:"134"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.brief_remark,function(e,o){return a("div",{key:o,staticClass:"gengjin_item"},[a("div",{domProps:{innerHTML:t._s(e.remark)}},[t._v(t._s(e.remark))]),t._v(" "),a("div",{staticClass:"gengjin_item_time"},[t._v(t._s(e.time))])])})}}],null,!1,2781881243)}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"104"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"caozuo_btn"},[a("el-button",{class:{no_take:e.row.has_take},on:{click:function(a){return t.toRenling(e.row)}}},[t._v("\n\t\t\t\t\t\t\t"+t._s(e.row.has_take?"取消认领":"认领")+"\n\t\t\t\t\t\t")]),t._v(" "),a("el-button",{staticClass:"to_detail_btn",on:{click:function(a){return t.toDetail(e.row,!0)}}},[t._v("详情")])],1)]}}],null,!1,2908116061)})],1):t._e()],1),t._v(" "),0!=t.total?a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize},on:{"current-change":t.pageChange}}):t._e(),t._v(" "),a("el-dialog",{attrs:{title:"添加新客户",visible:t.addCustomerDialog,"custom-class":"add_customer_dialog",center:!0,top:"12vh",width:"426px"},on:{"update:visible":function(e){t.addCustomerDialog=e}}},[a("el-form",{ref:"addCustomerForm",attrs:{model:t.addCustomerForm}},[a("el-form-item",{staticClass:"my_label",attrs:{label:"客户姓名","label-width":t.formLabelWidth,prop:"customer_name"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入客户姓名"},model:{value:t.addCustomerForm.customer_name,callback:function(e){t.$set(t.addCustomerForm,"customer_name",e)},expression:"addCustomerForm.customer_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"客户电话","label-width":t.formLabelWidth,prop:"customer_tel"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入客户电话"},model:{value:t.addCustomerForm.customer_tel,callback:function(e){t.$set(t.addCustomerForm,"customer_tel",e)},expression:"addCustomerForm.customer_tel"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"意向楼盘","label-width":t.formLabelWidth,prop:"house_name"}},[a("InputHouseSearch",{on:{"my-select":t.selectHouse},model:{value:t.addCustomerForm.house_name,callback:function(e){t.$set(t.addCustomerForm,"house_name",e)},expression:"addCustomerForm.house_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"意向区域","label-width":t.formLabelWidth,prop:"quyu"}},[a("el-cascader",{attrs:{placeholder:"请输入意向区域","expand-trigger":"click",options:t.cityOptions},on:{"active-item-change":t.cityItemChange},model:{value:t.addCustomerForm.quyu,callback:function(e){t.$set(t.addCustomerForm,"quyu",e)},expression:"addCustomerForm.quyu"}})],1)],1),t._v(" "),a("div",{staticClass:"tips"},[t._v("添加成功后需要等待5-10分钟，刷新新客户页面即可看到")]),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.saveNewCustomer}},[t._v("保存")])],1)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(o,s,!1,function(t){a("i4Nj")},"data-v-cf3c682a",null);e.default=r.exports},i4Nj:function(t,e){}});